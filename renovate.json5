{
  $schema: 'https://docs.renovatebot.com/renovate-schema.json',
  extends: ['local>coda/renovate-config'],

  packageRules: [
    // Node-fetch 3.x is ESM only; 2.x will continue to receive updates.
    {
      packageNames: ['node-fetch'],
      allowedVersions: '<3.0.0',
    },

    // yn 5.X and above is ESM only.
    {
      packageNames: ['yn'],
      allowedVersions: '<5.0.0',
    },

    // isolated-vm 4.4.2 has a known issue that should be fixed in 4.4.3
    {
      packageNames: ['isolated-vm'],
      allowedVersions: '!/^4\\.4\\.2$/',
    },

    // pnpm 8.6.0 moves to a new lockfile version.
    {
      packageNames: ['pnpm'],
      allowedVersions: '<8.6.0',
    },

    // see https://github.com/coda/packs-sdk/pull/2642
    {
      packageNames: ['open'],
      allowedVersions: '<9.0.0',
    },
  ],

  pip_requirements: {
    // Prevent renovate from trying to update requirements.txt, which is generated by "make bs"
    // To upgrade python dependencies, run "pipenv update" manually. Renovate doesn't seem to do
    // that for us.
    enabled: false,
  },

  postUpgradeTasks: {
    // NOTE(dweitzman)): _bootstrap-doc-tools doesn't work in the renovate container
    // at the moment so we skip building docs and just compile code.
    commands: ['make _bootstrap-renovate clean compile'],
    fileFilters: ['**/*.js', '**/*.d.ts', 'requirements.txt'],
  },
}
