<html>
  <head>
    <!-- Monaco library script is loaded from: https://cdnjs.com/libraries/monaco-editor-->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.38.0/min/vs/loader.min.js"
      integrity="sha512-A+6SvPGkIN9Rf0mUXmW4xh7rDvALXf/f0VtOUiHlDUSPknu2kcfz1KzLpOJyL2pO+nZS13hhIjLqVgiQExLJrw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script>
      require.config({
        paths: {
          vs: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.36.1/min/vs',
        },
      });

      require(['vs/editor/editor.main'], function () {
        var editor = monaco.editor.create(document.getElementById('container'), {
          value: "import * as coda from \"@codahq/packs-sdk\";\nexport const pack = coda.newPack();\n\nconst EmojiSchema = coda.makeObjectSchema({\n  properties: {\n    name: { type: coda.ValueType.String, fromKey: \"annotation\" },\n    hexcode: { type: coda.ValueType.String },\n    emoji: { type: coda.ValueType.String },\n    group: { type: coda.ValueType.String },\n    image: { \n      type: coda.ValueType.String, \n      codaType: coda.ValueHintType.ImageReference,\n    },\n  },\n  displayProperty: \"name\",\n  idProperty: \"hexcode\",\n  featuredProperties: [\"emoji\", \"group\", \"image\"],\n});\n\npack.addSyncTable({\n  name: \"Emojis\",\n  description: \"Lists all of the emojis.\",\n  identityName: \"Info\",\n  schema: EmojiSchema,\n  formula: {\n    name: \"SyncEmojis\",\n    description: \"Syncs the data.\",\n    parameters: [\n      coda.makeParameter({\n        type: coda.ParameterType.String,\n        name: \"group\",\n        description: \"If specified, only include emojis in this group.\",\n        optional: true,\n        autocomplete: [\n          \"smileys-emotion\", \"people-body\", \"component\", \"animals-nature\", \n          \"food-drink\", \"travel-places\", \"activities\", \"objects\", \"symbols\",\n        ],\n      }),\n    ],\n    execute: async function (args, context) {\n      let [group] = args;\n      let url = coda.withQueryParams(\"https://www.emoji.family/api/emojis\", {\n        group: group,\n      });\n      let response = await context.fetcher.fetch({\n        method: \"GET\",\n        url: url,\n      });\n      let emojis = response.body;\n      let rows = emojis.map(info => {\n        return {\n          // Start with all of the properties in the API response.\n          ...info,\n          image: `https://www.emoji.family/api/emojis/${info.emoji}/noto/png`,\n        };\n      });\n      return {\n        result: rows,\n      };\n    },\n  },\n});\n\npack.addNetworkDomain(\"emoji.family\");",
          language: 'javascript',
          minimap: {enabled: false},
          readOnly: true,
          renderValidationDecorations: 'off',
          wordWrap: 'on',
          contextmenu: false,
        });
      });
    </script>
  </head>
  <body>
    <div id="container" style="position: absolute; top: 0; right: 16; bottom: 16; left: 0"></div>
  </body>
</html>
